{% extends "base.html" %} {% block content %}
{% load cart_template_tags %}

<main>
  <section class="cart">
    <div class="container m-fluid mt-3">
        <div class="section--wrap flex align-end">
            <h1 class="section--wrap--title title-btn">買い物かご</h1>
            <div class="line-full"></div>
        </div>

        <div class="proceed-payment sp">
            <div class="container">
                <p class="title">税込合計<br>
                    （{{ request.user|cart_item_count }}商品）</p>
                <h1 class="payment-amount">¥{{ object.get_total }}-</h1>
                <a href="#" class="payment-btn">支払いへ進む</a>
            </div>
        </div>

        <div class="cart-starts">
            <div class="reports block">
              {% for order_item in object.items.all %}
              <!--Report starts-->
              <div class="report">
                  <div class="report-wrap">
                      <div class="report--thumb">
                          <a href="{{ order_item.item.get_absolute_url }}"><img class="width-fixed-200" src="{{ order_item.item.image.url }}" alt=""></a>
                      </div>
                      <div class="report-content">
                          <div class="data-wrap">
                              <h3 class="data--title">カテゴリ</h3>
                              <h3 class="data--content">{{ order_item.item.category }}{% for sub_category in order_item.item.subcategory.all %}/{{ sub_category.name }}{% endfor %}</h3>
                          </div>
                          <div class="data-wrap">
                              <h3 class="data--title">タイトル</h3>
                              <h3 class="data--content">{{ order_item.item.title }}</h3>
                          </div>
                          <div class="data-wrap">
                              <h3 class="data--title">出品者</h3>
                              <h3 class="data--content">{{ order_item.item.seller_name }}</h3>
                          </div>
                          <div class="data-wrap">
                              <h3 class="data--title">出品価格</h3>
                              {% if order_item.item.discount_price %}
                              <h3 class="data--content">¥{{ order_item.item.discount_price }}</h3>
                              {% else %}
                              <h3 class="data--content">¥{{ order_item.item.price }}</h3>
                              {% endif %}
                              <a href="{% url 'core:remove-from-cart' order_item.item.slug %}" class="btn-dlt sp">削除する</a>
                          </div>                          
                      </div>
                      <div class="delete-btn-wrap">
                          <a href="{% url 'core:remove-from-cart' order_item.item.slug %}" class="delete">削除する</a>
                      </div>
                  </div>
              </div>
              <!--Report ends-->
              {% empty %}
              <div class="report">
                <h3 class="data--title">カートが空です</h3>                
              </div>
              {% endfor %}
            </div>            

            {% if object.get_total %}
            <div class="cart-payment-detail-box radius-orange-box pc">
                <h1 class="total-item">税込合計　(<span class="ïtem">{{ request.user|cart_item_count }}商品</span>)</h1>
                <input type="text" class="price" value="¥{{ object.get_total }}-">
                <a href="/payment/stripe/" class="procede-btn">お支払い手続きへ進む</a>
            </div>
            {% endif %}
        </div>
    </div>
  </section>
</main>

{% endblock content %}
